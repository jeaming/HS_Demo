#define TK	(unsigned char*)"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
#define DCCK	(unsigned char*)"\xF4\x23\x59\xA1\xAF\x4D\x15\x8A\x67\xE8\xFD\x2D\x15\x0E\x26\xF7"
#define CMK	(unsigned char*)"\x1A\xE5\x7A\x56\xBA\x58\x0C\x12\x4D\x40\xE8\xA7\xC7\x12\x51\x65"
#define EAK	(unsigned char*)"\x10\x97\xB5\xC8\xBE\x0E\x43\xE4\x53\x24\x63\x1D\x4F\xA4\x44\x27"
#define PUK	(unsigned char*)"\x1E\xA3\x5C\x35\xAD\x61\xDF\xD2\xD7\x25\x46\xEB\x28\xA4\x3F\x70"
#define PRK	(unsigned char*)"\x1E\xAE\xB3\x7A\x21\xB9\xDE\xA2\xA2\x9E\x39\x0E\x44\x97\x38\xB8"
#define PIN	(unsigned char*)"\x12\x34\x56\xFF\xFF\xFF\xFF\xFF"
		(unsigned char*)
#define AMK	(unsigned char*)"\xDF\x1A\x09\x56\x51\x83\x40\xB4\x53\xA4\x49\x2A\x00\xB7\xEA\x2F"
#define APUK	(unsigned char*)"\xE1\x6E\xCB\xD7\x90\x2D\xF6\xAA\x7A\x70\xD5\x71\xF8\x0D\x2D\xE6"
#define APRK	(unsigned char*)"\xE8\x6B\x00\x5A\x61\x6D\x67\xB3\x5A\xD6\x49\xEC\xB4\xA1\x9D\x82"
#define APK1	(unsigned char*)"\x17\xE6\x7D\xC5\x0B\x85\x78\xAD\xFE\xA8\x8B\x2B\x43\x5C\x9A\xDE"
#define APK2	(unsigned char*)"\x5F\x9F\x18\x0F\x23\xDC\xD8\x4C\xAD\xFF\xDE\x39\x97\xF3\x67\xB1"
#define ALK	(unsigned char*)"\xF4\x48\x2A\xE9\xE0\x8D\x8B\xA0\x34\xE9\x97\x22\x74\xC6\xEE\x71"
#define ATK	(unsigned char*)"\xCB\x7D\x0C\xD3\x98\xD3\x78\xEE\x17\xF9\x91\xBA\x9D\xE5\x54\x21" 
#define EK	(unsigned char*)"\x71\x3C\x52\xAE\xA9\xE2\x0A\xBC\x5F\xC0\x15\xB8\xA5\xB8\x95\xC2"





















reset

00 84 00 00 08
set rand
auth_data = 3des_encode_ecb($rand, $tk)
00 82 00 00 08 $auth_data
if sw != 9000
	? "хож╓й╖╟эё╛й╧сцDCCKхож╓"
	00 84 00 00 08
	set rand
	auth_data = 3des_encode_ecb($rand, $dcck)
	00 82 00 00 08 $auth_data
	if sw != 9000
		? "хож╓й╖╟э"
		pause
	endif
endif
//auth dcck

800E0000
//delete MF



80E03F000D38FFFFAAAAFFFFFFFFFFFFFFFF
if sw != 9000
	? "╢╢╫╗MFй╖╟э"
//	pause
endif
//Create MF

80E00000073F00EB01AAFFFF
if sw != 9000
	? "╢╢╫╗KEYнд╪Чй╖╟э"
	pause
endif
//Create key file


//////////////////////////////////

80D401011539F0AA0766$deak
80D401011536F0FAFF66$dcmk
80D401001537F0FAFF66$dpuk
80D401001538F0FAFF66$dprk

if $card_type == 00
	80D401011530F0FAFF66$dek
	if sw != 9000
		pause
	endif
endif
//	dek 01

80E03F000D38FFFFAAAAFFFFFFFFFFFFFFFF
80E00000073F00EB01AAFFFF
80D401001539F0AA0A66F42359A1AF4D158A67E8FD2D150E26F7


80D401000D3AF0EF0566123456FFFFFFFFFF
80E0EF0507280011F0FAFFFE
80E0EF0607A80606F0F0FFFE
80E0EF0707A80080F0F0FFFE
80E0EF0807A80040F0F0FFFE
80E0EF0907A80040F0F0FFFE
80E0DF0111381000AAAAFFFFFFA00000000386980701
80E00000073F00EB01AAFFFF
80D401001539F0AA0A6600000000000000000000000000000000
80D401000D3AF0EF0566123456FFFFFFFFFF
80E0EF0507A80004F0F0FFFE
80E0EF0607A80410F0F0FFFE
80E00018072E0A17F0EFFFFF
80E00002072F0208F001FF18




00A4000002DF01
80D439001539F0AA0A66 $dack
80D401011539F0AA0766 $deak
80D401011536F0FAFF66 $damk
80D401001537F0FAFF66 $dapuk
80D401001538F0FAFF66 $daprk
80D40101153EF0FA0100 $dapk1
80D40102153EF0FA0200 $dapk2
80D40101153FF0FA0100 $dalk
80D401011534F0FA0100 $datk



00D60000 0B $card_type $card_no_hex
if sw != 9000
	pause
endif
//update EF05

















C8B995DAB1DBE54EFB0B5F25F2BE1486
65390BF8A050D488

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;	TEST CONSTRACT
;;;;;;;;;;;;;;;;;;;;;;;;;

SAVE(TMK) FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
SAVE(KEY) 00000000000000000000000000000000
SAVE(EAK) 713C52AEA9E20ABC5FC015B8A5B895C2


SAVE(TR_NO) 003010 000001
SAVE(TER) 33 30
SAVE(TER_ID) 3130 30303030 3031

SAVE(DEAK) DIV(%EAK%, %TER_ID%)

reset

80E0000018FFFFFFFFFFFFFFFFAF01315041592E5359532E4444463031
80E0020007000005AFAF1000
80D40000170000000F0FAF66F42359A1AF4D158A67E8FD2D150E26F7
80D400000F00000B110FAF66123456FFFFFFFFFF
80E00200070001400F0F00FE
80E00200070015000FAF000E
80E00200070016000FAF0006
80E001000CDF01AF004D574F4840424A01
80E0020007000005FFFFA000
80D40000170000000F0FFF66F42359A1AF4D158A67E8FD2D150E26F7
80D400000F00000B110FAF66123456FFFFFFFFFF
80D40000170A00280F00FF331AE57A56BA580C124D40E8A7C7125165
80D40000171A00280F00FF331EA35C35AD61DFD2D72546EB28A43F70
80D40000171B00240F00FF331EAEB37A21B9DEA2A29E390E449738B8
80D40000171C00280F00FF33DF1A0956518340B453A4492A00B7EA2F
80D40000171D00280F00FF33E16ECBD7902DF6AA7A70D571F80D2DE6
80D40000171E00240F00FF33E86B005A616D67B35AD649ECB4A19D82
80D40000171F00280F00FF331097B5C8BE0E43E45324631D4FA44427
80D40000172100280F00FF33CB7D0CD398D378EE17F991BA9DE55421
80D40000172200280F00FF33F4482AE9E08D8BA034E9972274C6EE71
80D40000170100220F00FF3317E67DC50B8578ADFEA88B2B435C9ADE
80D40000170200220F00FF335F9F180F23DCD84CADFFDE3997F367B1
80E0010102DF01
80E00001023F00





3F00

00D695000E %TER_ID% 8B4901 31 2000
00D6960006 %TR_NO%




80D40000170100000F77FFEE %DEAK%

INSERT INTO UidLog(UID,FACTRY,INITIAL_DATE,ROTATE_UID,MIFARE_INITED,CSN,ATS,PATCH,SN) Values('','MINGHUA','2018-05-08','3435973836', '0','3130303030303031','500D09B5EEDBA0C119008181','0','ллллллллллллллллллллллллллллллллллллллллF42359A1AF4D158A67E8FD2D150E26F7');